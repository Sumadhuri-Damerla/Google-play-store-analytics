---
title: "Google Play Store Analytics"
output: html_document
runtime: shiny
---


```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=10, fig.height=8,echo=FALSE, warning=FALSE, message=FALSE)
```


```{r load-libraries}
library(tidyverse)
library(dplyr)
library(stringr)
require(ggExtra) # For marginal graphs
require(GGally) #for correlation plot
library(shiny)
library(wordcloud2)
```

```{r loading-data}
clean_play_store <- read_csv("data/tidyplaystore.csv") #read_csv returns a dataframe
```


```{r functions for dashboard}
library(tm)
library(tmap)
create_wordcloud <- function(data, num_words = 100, background = "white") {
  
  # If text is provided, convert it to a dataframe of word frequencies
  if (is.character(data)) {
    corpus <- Corpus(VectorSource(data))
    corpus <- tm_map(corpus, tolower)
    corpus <- tm_map(corpus, removePunctuation)
    corpus <- tm_map(corpus, removeNumbers)
    corpus <- tm_map(corpus, removeWords, stopwords("english"))
    tdm <- as.matrix(TermDocumentMatrix(corpus))
    data <- sort(rowSums(tdm), decreasing = TRUE)
    data <- data.frame(word = names(data), freq = as.numeric(data))
  }
  
  # Make sure a proper num_words is provided
  if (!is.numeric(num_words) || num_words < 3) {
    num_words <- 3
  }  
  
  # Grab the top n most common words
  data <- head(data, n = num_words)
  if (nrow(data) == 0) {
    return(NULL)
  }
  
  wordcloud2(data, backgroundColor = background)
}
```

```{r dashboard}
# Define UI for the application
ui <- fluidPage(
  sidebarPanel(
    selectInput("variable", "Choose a variable:", choices = unique(clean_play_store$category))
  ),
  mainPanel(
    tabsetPanel(
      tabPanel(),
      tabPanel()
    )
  ),
  # Add the word cloud output placeholder to the UI
  wordcloud2Output(outputId = "cloud")
)

# Define the server logic
server <- function(input, output) {
  # Render the word cloud and assign it to the output list
  output$cloud <- renderWordcloud2({
    # Create a word cloud object
    create_wordcloud(clean_play_store$category)
  })
}


# Run the application
shinyApp(ui = ui, server = server)
```